!function(){"use strict";var e=class{constructor(e,t,s,n,r){let{name:o,link:i,_id:a,isLiked:l}=e;this._name=o,this._link=i,this._handleImageClick=s,this._cardSelector=t,this._id=a,this._isLiked=l,this._handleTrashClick=n,this._handleLikeClick=r}_getTemplate(){return document.querySelector(this._cardSelector).content.firstElementChild.cloneNode(!0)}_setEventListeners(){this._cardElement.querySelector(".card__button-like").addEventListener("click",(()=>{this._handleLikeIcon()})),this._cardElement.querySelector(".card__button-remove").addEventListener("click",(()=>{this._handleRemoveCard()})),this._cardElement.querySelector(".card__image").addEventListener("click",(()=>{this._handleImageClick({name:this._name,link:this._link})}))}_handleLikeIcon(){this._cardElement.querySelector(".card__button-like").classList.toggle("card__button-like_active")}_handleRemoveCard(){this._cardElement.remove(),this._cardElement=null}getView(){this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card__list-item").cloneNode(!0);const e=this._cardElement.querySelector(".card__image");return e.src=this._link,e.alt=`Image of ${this._name}`,this._cardElement.querySelector(".card__title").textContent=this._name,this._setEventListeners(),this._cardElement}};class t{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._errorMessageEl=e.errorMessageEl,this._formElement=t,this._inputElements=[...this._formElement.querySelectorAll(this._inputSelector)],this._submitButton=this._formElement.querySelector(this._submitButtonSelector)}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t?(t.textContent=e.validationMessage,t.classList.add(this._errorClass)):console.warn(`Error element for ${e.id} not found.`)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t?t.textContent="":console.warn(`Error element for ${e.id} not found.`)}_hasInvalidInput(){return!this._inputElements.every((e=>e.validity.valid))}toggleButtonState(){if(this._hasInvalidInput())return this._submitButton.classList.add(this._inactiveButtonClass),void(this._submitButton.disabled=!0);this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_checkInputValidity(e,t){e.validity.valid?this._hideInputError(e,t):this._showInputError(e)}_setEventListeners(){this._inputElements.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e,this._formElement),this.toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._inputElements.forEach((e=>{this._hideInputError(e)})),this.toggleButtonState()}}class s{constructor(e){this._popupElement=document.querySelector(e),this._open=this.open.bind(this),this._close=this.close.bind(this),this._handleEscClose=this.handleEscClose.bind(this)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popupElement.addEventListener("click",(e=>{e.target.classList.contains("modal_opened")&&this.close()})),this._popupElement.querySelector(".modal__close").addEventListener("click",(()=>{this.close()}))}}var n=class extends s{constructor(e,t){super(e),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t}close(){this._popupForm.reset(),super.close()}_getInputValues(){return this._inputList=this._popupElement.querySelectorAll(".modal__input"),this._inputValues={},this._inputList.forEach((e=>{this._inputValues[e.name]=e.value})),this._inputValues}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{this._handleFormSubmit(this._getInputValues())}))}};class r{constructor(e,t){let{items:s,renderer:n}=e;this._items=s,this._renderer=n,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}const o=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:{authorization:this._headers}}).then((e=>this._checkResponse(e)))}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:{authorization:this._authToken}}).then((e=>this._checkResponse(e)))}createCard(e){let{name:t,link:s}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",body:JSON.stringify({name:t,link:s}),headers:this._headers}).then(this._checkResponse)}updateEditProfile(e){let{name:t,about:s}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",body:JSON.stringify({name:t,about:s}),headers:this._headers}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._checkResponse)}unlikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}updateAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",body:JSON.stringify({avatar:e}),headers:this._headers}).then(this._checkResponse)}getAllData(){return Promise.all([this._getUserInfo(),this._getInitialCards()])}}({baseUrl:"https://example.com",headers:"your-auth-token"}),i=new class{constructor(e){let{nameSelector:t,jobSelector:s}=e;this._nameElement=document.querySelector(t),this._aboutElement=document.querySelector(s)}getUserInfo(){return{name:this._nameElement.textContent,job:this._aboutElement.textContent}}setUserInfo(e){let{name:t,about:s}=e;this._nameElement.textContent=t,this._aboutElement.textContent=s}}({nameSelector:".profile__name",jobSelector:".profile__job"}),a=new n({popupSelector:".popup_type_edit-profile",formSubmitHandler:C}),l=new n({popupSelector:".popup_type_add-card",formSubmitHandler:q}),c=new class extends s{constructor(e){super(e),this._popupImage=this._popupElement.querySelector(".modal__image"),this._popupTitle=this._popupElement.querySelector(".modal__title")}open(e){let{name:t,link:s}=e;this._popupImage.src=s,this._popupImage.alt=t,this._popupTitle.textContent=t,super.open()}}(".popup_type_image"),d=document.querySelector(".profile__add-button"),u=document.querySelector(".profile__edit-button"),h=document.querySelector(".popup_type_edit-profile .popup__close-button"),_=document.querySelector(".popup_type_add-card .popup__close-button"),p=document.querySelector(".popup_type_image .popup__close-button"),m=document.querySelector(".popup_type_edit-profile"),E=document.querySelector(".popup_type_add-card"),f=document.querySelector(".popup_type_image"),S=document.querySelector(".popup_type_edit-profile .popup__input_type_name"),y=document.querySelector(".popup_type_edit-profile .popup__input_type_description"),b=document.querySelector("#add-card-form"),g=document.querySelector("#edit-card-form"),v=new t(config,b),k=new t(config,g);function L(t){const s=new e({data:t,handleCardClick:()=>{c.open(t.name,t.link)},handleLikeClick:()=>{const e=s.isLiked();o.changeLikeCardStatus(t._id,!e).then((e=>{s.updateLikes(e.likes)})).catch((e=>{console.log(e)}))},handleTrashClick:()=>{const e=t._id,n=new PopupWithConfirm({popupSelector:".popup_type_confirm-delete",formSubmitHandler:()=>{o.deleteCard(e).then((()=>{s.deleteCard(),n.close()})).catch((e=>{console.log(e)}))}});n.open()}},"#card-template");return s.generateCard()}function C(e){a.setLoading(!0),o.editUserInfo(e).then((e=>{i.setUserInfo(e),a.close()})).catch((e=>{console.log(e)})).finally((()=>{a.setLoading(!1)}))}function q(e){l.setLoading(!0),o.addCard(e).then((e=>{const t=L(e);document.querySelector(".cards__list").prepend(t),l.close()})).catch((e=>{console.log(e)})).finally((()=>{l.setLoading(!1)}))}function I(e){if(e.target===e.currentTarget){const t=e.target.querySelector(".popup");t&&t.classList.remove("popup_opened")}}o.getAllData().then((e=>{let[t,s]=e;i.setUserInfo(t);const n=new r({items:s,renderer:e=>{const t=L(e);n.addItem(t)}},".cards__list");n.renderItems()})).catch((e=>{console.log(e)})),u.addEventListener("click",(()=>{const e=i.getUserInfo();S.value=e.name,y.value=e.job,a.open()})),h.addEventListener("click",(()=>{a.close()})),p.addEventListener("click",(()=>{c.close()})),m.addEventListener("mousedown",I),E.addEventListener("mousedown",I),f.addEventListener("mousedown",I),d.addEventListener("click",(()=>{v.resetValidation(),v.toggleButtonState(),l.open()})),_.addEventListener("click",(()=>l.close())),g.addEventListener("submit",(e=>{e.preventDefault(),k.setLoading(!0),k.disableSubmitButton(),C(new FormData(e.target))})),b.addEventListener("submit",(e=>{e.preventDefault(),v.setLoading(!0),v.disableSubmitButton(),q(new FormData(e.target))})),v.enableValidation(),k.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ckosaUJBQWlCLFlBQWFtTCxHQUVoRHJDLEVBQWlCOUksaUJBQWlCLFNBQVMsS0FDNUMwSixFQUFpQnhHLGtCQUNqQndHLEVBQWlCaEgsb0JBQ2pCK0YsRUFBYWxGLE1BQU0sSUFHbEIwRixFQUF3QmpKLGlCQUFpQixTQUFTLElBQU15SSxFQUFhL0UsVUFFckUrRixFQUFnQnpKLGlCQUFpQixVQUFXb0wsSUFDN0NBLEVBQU1uSSxpQkFDTjBHLEVBQXFCa0IsWUFBVyxHQUNoQ2xCLEVBQXFCK0Isc0JBQ3JCbEQsRUFBd0IsSUFBSW1ELFNBQVNQLEVBQU1wSCxRQUFRLElBR2xEd0YsRUFBZXhKLGlCQUFpQixVQUFXb0wsSUFDNUNBLEVBQU1uSSxpQkFDTnlHLEVBQWlCbUIsWUFBVyxHQUM1Qm5CLEVBQWlCZ0Msc0JBQ2pCaEQsRUFBd0IsSUFBSWlELFNBQVNQLEVBQU1wSCxRQUFRLElBR2xEMEYsRUFBaUIzRyxtQkFDakI0RyxFQUFxQjVHLGtCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIENhcmQge1xuXHRjb25zdHJ1Y3Rvcih7IG5hbWUsIGxpbmssIF9pZCwgaXNMaWtlZCB9LCBcblx0XHRjYXJkU2VsZWN0b3IsIFxuXHRcdGhhbmRsZUltYWdlQ2xpY2ssXG5cdFx0aGFuZGxlVHJhc2hDbGljayxcblx0XHRoYW5kbGVMaWtlQ2xpY2spIHtcblx0XHR0aGlzLl9uYW1lID0gbmFtZTtcblx0XHR0aGlzLl9saW5rID0gbGluaztcblx0XHR0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcblx0XHR0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XG5cdFx0dGhpcy5faWQgPSBfaWQ7XG5cdFx0dGhpcy5faXNMaWtlZCA9IGlzTGlrZWQ7XG5cdFx0dGhpcy5faGFuZGxlVHJhc2hDbGljayA9IGhhbmRsZVRyYXNoQ2xpY2s7XG5cdFx0dGhpcy5faGFuZGxlTGlrZUNsaWNrID0gaGFuZGxlTGlrZUNsaWNrO1xuXHR9XG5cblx0X2dldFRlbXBsYXRlKCkge1xuXHRcdGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnRcblx0XHRcdC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3Rvcilcblx0XHRcdC5jb250ZW50LmZpcnN0RWxlbWVudENoaWxkLmNsb25lTm9kZSh0cnVlKTtcblx0XHRyZXR1cm4gY2FyZEVsZW1lbnQ7XG5cdH1cblxuXHRfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG5cdFx0Ly8gY2FyZCBsaWtlIGJ1dHRvblxuXHRcdHRoaXMuX2NhcmRFbGVtZW50XG5cdFx0XHQucXVlcnlTZWxlY3RvcignLmNhcmRfX2J1dHRvbi1saWtlJylcblx0XHRcdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRcdFx0dGhpcy5faGFuZGxlTGlrZUljb24oKTtcblx0XHRcdH0pO1xuXHRcdC8vIGNhcmQgZGVsZXRlIGJ1dHRvblxuXHRcdHRoaXMuX2NhcmRFbGVtZW50XG5cdFx0XHQucXVlcnlTZWxlY3RvcignLmNhcmRfX2J1dHRvbi1yZW1vdmUnKVxuXHRcdFx0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuXHRcdFx0XHR0aGlzLl9oYW5kbGVSZW1vdmVDYXJkKCk7XG5cdFx0XHR9KTtcblxuXHRcdHRoaXMuX2NhcmRFbGVtZW50XG5cdFx0XHQucXVlcnlTZWxlY3RvcignLmNhcmRfX2ltYWdlJylcblx0XHRcdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRcdFx0dGhpcy5faGFuZGxlSW1hZ2VDbGljayh7XG5cdFx0XHRcdFx0bmFtZTogdGhpcy5fbmFtZSxcblx0XHRcdFx0XHRsaW5rOiB0aGlzLl9saW5rLFxuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXHR9XG5cblx0X2hhbmRsZUxpa2VJY29uKCkge1xuXHRcdHRoaXMuX2NhcmRFbGVtZW50XG5cdFx0XHQucXVlcnlTZWxlY3RvcignLmNhcmRfX2J1dHRvbi1saWtlJylcblx0XHRcdC5jbGFzc0xpc3QudG9nZ2xlKCdjYXJkX19idXR0b24tbGlrZV9hY3RpdmUnKTtcblx0fVxuXHRfaGFuZGxlUmVtb3ZlQ2FyZCgpIHtcblx0XHR0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcblx0XHR0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XG5cdH1cblxuXHRnZXRWaWV3KCkge1xuXHRcdHRoaXMuX2NhcmRFbGVtZW50ID0gZG9jdW1lbnRcblx0XHRcdC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3Rvcilcblx0XHRcdC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saXN0LWl0ZW0nKVxuXHRcdFx0LmNsb25lTm9kZSh0cnVlKTtcblxuXHRcdGNvbnN0IGNhcmRJbWFnZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19pbWFnZScpO1xuXHRcdGNhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xuXHRcdGNhcmRJbWFnZS5hbHQgPSBgSW1hZ2Ugb2YgJHt0aGlzLl9uYW1lfWA7XG5cblx0XHR0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fdGl0bGUnKS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XG5cdFx0Ly8gc2V0IGV2ZW50IGxpc3RlbmVyc1xuXHRcdHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG5cdFx0Ly8gcmV0dXJuIGNhcmRcblx0XHRyZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XG5cdH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgQ2FyZDtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuXHRjb25zdHJ1Y3Rvcihjb25maWcsIGZvcm1FbGVtZW50KSB7XG5cdFx0dGhpcy5faW5wdXRTZWxlY3RvciA9IGNvbmZpZy5pbnB1dFNlbGVjdG9yO1xuXHRcdHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuXHRcdHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcztcblx0XHR0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBjb25maWcuaW5wdXRFcnJvckNsYXNzO1xuXHRcdHRoaXMuX2Vycm9yQ2xhc3MgPSBjb25maWcuZXJyb3JDbGFzcztcblx0XHR0aGlzLl9lcnJvck1lc3NhZ2VFbCA9IGNvbmZpZy5lcnJvck1lc3NhZ2VFbDtcblx0XHR0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuXHRcdHRoaXMuX2lucHV0RWxlbWVudHMgPSBbXG5cdFx0XHQuLi50aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpLFxuXHRcdF07XG5cdFx0dGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcihcblx0XHRcdHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yXG5cdFx0KTtcblx0fVxuXG5cdF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcblx0XHRjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG5cdFx0XHRgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcblx0XHQpO1xuXHRcdGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG5cdFx0aWYgKGVycm9yTWVzc2FnZUVsKSB7XG5cdFx0XHRlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZTtcblx0XHRcdGVycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnNvbGUud2FybihgRXJyb3IgZWxlbWVudCBmb3IgJHtpbnB1dEVsZW1lbnQuaWR9IG5vdCBmb3VuZC5gKTtcblx0XHR9XG5cdH1cblxuXHRfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG5cdFx0Y29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuXHRcdFx0YCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXG5cdFx0KTtcblx0XHRpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuXHRcdGlmIChlcnJvck1lc3NhZ2VFbCkge1xuXHRcdFx0ZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSAnJztcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc29sZS53YXJuKGBFcnJvciBlbGVtZW50IGZvciAke2lucHV0RWxlbWVudC5pZH0gbm90IGZvdW5kLmApO1xuXHRcdH1cblx0fVxuXG5cdF9oYXNJbnZhbGlkSW5wdXQoKSB7XG5cdFx0cmV0dXJuICF0aGlzLl9pbnB1dEVsZW1lbnRzLmV2ZXJ5KFxuXHRcdFx0KGlucHV0RWxlbWVudCkgPT4gaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkXG5cdFx0KTtcblx0fVxuXG5cdHRvZ2dsZUJ1dHRvblN0YXRlKCkge1xuXHRcdGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQoKSkge1xuXHRcdFx0dGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG5cdFx0XHR0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHR0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcblx0XHR0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcblx0fVxuXG5cdF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50LCBmb3JtRWxzKSB7XG5cdFx0aWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcblx0XHRcdHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgZm9ybUVscyk7XG5cdFx0fVxuXHR9XG5cblx0X3NldEV2ZW50TGlzdGVuZXJzKCkge1xuXHRcdHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG5cdFx0XHRpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XG5cdFx0XHRcdHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQsIHRoaXMuX2Zvcm1FbGVtZW50KTtcblx0XHRcdFx0dGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpO1xuXHRcdFx0fSk7XG5cdFx0fSk7XG5cdH1cblxuXHRlbmFibGVWYWxpZGF0aW9uKCkge1xuXHRcdHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChlKSA9PiB7XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0fSk7XG5cdFx0dGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblx0fVxuXG5cdHJlc2V0VmFsaWRhdGlvbigpIHtcblx0XHR0aGlzLl9pbnB1dEVsZW1lbnRzLmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuXHRcdFx0dGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcblx0XHR9KTtcblx0XHR0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XG5cdH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgICAgIHRoaXMuX29wZW4gPSB0aGlzLm9wZW4uYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5fY2xvc2UgPSB0aGlzLmNsb3NlLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xuICAgIH1cblxuICAgIG9wZW4oKSB7XG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdtb2RhbF9vcGVuZWQnKTtcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICB9XG5cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ21vZGFsX29wZW5lZCcpO1xuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgIH1cblxuICAgIGhhbmRsZUVzY0Nsb3NlKGUpIHtcbiAgICAgICAgaWYgKGUua2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgICAgICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RhbF9vcGVuZWQnKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Nsb3NlJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSAnLi9Qb3B1cC5qcyc7XG5cbmNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xuICAgICAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fZm9ybScpO1xuICAgICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICB9XG5cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XG4gICAgICAgIHN1cGVyLmNsb3NlKCk7XG4gICAgfVxuXG4gICAgX2dldElucHV0VmFsdWVzKCkge1xuICAgICAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm1vZGFsX19pbnB1dCcpO1xuICAgICAgICB0aGlzLl9pbnB1dFZhbHVlcyA9IHt9O1xuICAgICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaChpbnB1dCA9PiB7XG4gICAgICAgICAgdGhpcy5faW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB0aGlzLl9pbnB1dFZhbHVlcztcbiAgICAgIH1cblxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgICAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGUpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxufVxuXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhGb3JtOyIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICAgIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xuICAgICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xuICAgIH1cbiAgXG4gICAgcmVuZGVySXRlbXMoKSB7XG4gICAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgXG4gICAgYWRkSXRlbShlbGVtZW50KSB7XG4gICAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgICB9XG4gIH0iLCJpbXBvcnQgQ2FyZCBmcm9tICcuLi9jb21wb25lbnRzL0NhcmQuanMnO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSAnLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzJztcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gJy4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyc7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSAnLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyc7XG5pbXBvcnQgU2VjdGlvbiBmcm9tICcuLi9jb21wb25lbnRzL1NlY3Rpb24uanMnO1xuaW1wb3J0IFVzZXJJbmZvIGZyb20gJy4uL2NvbXBvbmVudHMvVXNlckluZm8uanMnO1xuaW1wb3J0IEFwaSBmcm9tICcuLi9jb21wb25lbnRzL0FwaS5qcyc7XG5pbXBvcnQgJy4uL3BhZ2VzL2luZGV4LmNzcyc7XG5cbi8vIGNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuLy8gXHRiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXG4vLyBcdGhlYWRlcnM6IHtcbi8vIFx0XHRhdXRob3JpemF0aW9uOiBcIjU4ZmViMGZlYy1iOWY1LTRiYzMtYjEwOC1iYjY4ODI1ZWY1NjU0XCIsXG4vLyBcdFx0XCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4vLyBcdH1cbi8vIH0pO1xuLy8gY29uc3QgaW5pdGlhbENhcmRzID0gW1xuLy8gXHR7XG4vLyBcdFx0bmFtZTogJ1lvc2VtaXRlIFZhbGxleScsXG4vLyBcdFx0bGluazogJ2h0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnJyxcbi8vIFx0fSxcbi8vIFx0e1xuLy8gXHRcdG5hbWU6ICdMYWtlIExvdWlzZScsXG4vLyBcdFx0bGluazogJ2h0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFrZS1sb3Vpc2UuanBnJyxcbi8vIFx0fSxcbi8vIFx0e1xuLy8gXHRcdG5hbWU6ICdCYWxkIE1vdW50YWlucycsXG4vLyBcdFx0bGluazogJ2h0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnJyxcbi8vIFx0fSxcbi8vIFx0e1xuLy8gXHRcdG5hbWU6ICdMYXRlbWFyJyxcbi8vIFx0XHRsaW5rOiAnaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZycsXG4vLyBcdH0sXG4vLyBcdHtcbi8vIFx0XHRuYW1lOiAnVmFub2lzZSBOYXRpb25hbCBQYXJrJyxcbi8vIFx0XHRsaW5rOiAnaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZycsXG4vLyBcdH0sXG4vLyBcdHtcbi8vIFx0XHRuYW1lOiAnTGFnbyBkaSBCcmFpZXMnLFxuLy8gXHRcdGxpbms6ICdodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnJyxcbi8vIFx0fSxcbi8vIF07XG5cbi8vIC8vIGVkaXQgcHJvZmlsZVxuLy8gY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcHJvZmlsZS1lZGl0LWJ1dHRvbicpO1xuLy8gY29uc3QgcHJvZmlsZUVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwcm9maWxlLWVkaXQtbW9kYWwnKTtcbi8vIGNvbnN0IHByb2ZpbGVFZGl0Q2xvc2VCdXR0b24gPSBwcm9maWxlRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2xvc2UnKTtcblxuLy8gLy8gcHJldmlld1xuLy8gY29uc3QgcHJldmlld0ltYWdlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcHJldmlldy1pbWFnZS1tb2RhbCcpO1xuLy8gY29uc3QgcHJldmlld0ltYWdlTW9kYWxDbG9zZUJ1dHRvbiA9XG4vLyBcdHByZXZpZXdJbWFnZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2xvc2UnKTtcblxuLy8gLy8gYWRkIGNhcmRcbi8vIGNvbnN0IGFkZENhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNhZGQtY2FyZC1tb2RhbCcpO1xuLy8gY29uc3QgYWRkQ2FyZE1vZGFsQ2xvc2VCdXR0b24gPSBhZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZScpO1xuLy8gY29uc3QgcHJvZmlsZVRpdGxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcHJvZmlsZS10aXRsZS1pbnB1dCcpO1xuLy8gY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuLy8gXHQnI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXQnXG4vLyApO1xuLy8gY29uc3QgYWRkTmV3Q2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hZGQtYnV0dG9uJyk7XG4vLyBjb25zdCBhZGRDYXJkRm9ybUVsZW1lbnQgPSBhZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19mb3JtJyk7XG4vLyBjb25zdCBjYXJkVXJsSW5wdXQgPSBhZGRDYXJkRm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcignI2Zvcm0taW5wdXQtdXJsJyk7XG4vLyBjb25zdCBjYXJkVGl0bGVJbnB1dCA9IGFkZENhcmRGb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcjZm9ybS1pbnB1dC10aXRsZScpO1xuXG4vLyAvLyB0ZW1wbGF0ZVxuLy8gY29uc3QgY2FyZExpc3RFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkc19fbGlzdCcpO1xuXG4vLyBjb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XG4vLyBcdG5hbWVTZWxlY3RvcjogJy5wcm9maWxlX190aXRsZScsXG4vLyBcdGpvYlNlbGVjdG9yOiAnLnByb2ZpbGVfX2Rlc2NyaXB0aW9uJyxcbi8vIH0pO1xuXG4vLyBjb25zdCBlZGl0UHJvZmlsZVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4vLyBcdCcjcHJvZmlsZS1lZGl0LW1vZGFsJyxcbi8vIFx0aGFuZGxlUHJvZmlsZUVkaXRTdWJtaXRcbi8vICk7XG4vLyBlZGl0UHJvZmlsZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vIGNvbnN0IGFkZENhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuLy8gXHQnI2FkZC1jYXJkLW1vZGFsJyxcbi8vIFx0aGFuZGxlQWRkQ2FyZEZvcm1TdWJtaXRcbi8vICk7XG4vLyBhZGRDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy8gY29uc3QgcG9wdXBJbWFnZU1vZGFsID0gbmV3IFBvcHVwV2l0aEltYWdlKCcjcHJldmlldy1pbWFnZS1tb2RhbCcpO1xuLy8gcG9wdXBJbWFnZU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vIGNvbnN0IGNhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24oXG4vLyBcdHtcbi8vIFx0XHRpdGVtczogaW5pdGlhbENhcmRzLFxuLy8gXHRcdHJlbmRlcmVyOiByZW5kZXJDYXJkLFxuLy8gXHR9LFxuLy8gXHQnLmNhcmRzX19saXN0J1xuLy8gKTtcbi8vIGNhcmRTZWN0aW9uLnJlbmRlckl0ZW1zKCk7XG5cbi8vIGZ1bmN0aW9uIHJlbmRlckNhcmQoY2FyZERhdGEpIHtcbi8vIFx0Y29uc3QgY2FyZCA9IG5ldyBDYXJkKFxuLy8gXHRcdGNhcmREYXRhLCBcbi8vIFx0XHQnI2NhcmQtdGVtcGxhdGUnLCBcbi8vIFx0XHRoYW5kbGVJbWFnZUNsaWNrLCBcbi8vIFx0XHRoYW5kbGVMaWtlQ2xpY2ssXG4vLyBcdFx0aGFuZGxlVHJhc2hDbGljayk7XG4vLyBcdGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZC5nZXRWaWV3KCk7XG4vLyBcdGNhcmRTZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xuLy8gfVxuXG4vLyBmdW5jdGlvbiBoYW5kbGVPdmVybGF5Q2xvc2UoZSkge1xuLy8gXHRpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RhbF9vcGVuZWQnKSkge1xuLy8gXHRcdHBvcHVwSW1hZ2VNb2RhbC5jbG9zZSgpO1xuLy8gXHR9XG4vLyB9XG5cbi8vIGZ1bmN0aW9uIGhhbmRsZUltYWdlQ2xpY2sobmFtZSwgbGluaykge1xuLy8gXHRwb3B1cEltYWdlTW9kYWwub3BlbihuYW1lLCBsaW5rKTtcbi8vIH1cblxuLy8gZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXQodmFsdWUpIHtcbi8vIFx0dXNlckluZm8uc2V0VXNlckluZm8odmFsdWUpO1xuLy8gXHRlZGl0UHJvZmlsZVBvcHVwLmNsb3NlKCk7XG4vLyB9XG4vLyBmdW5jdGlvbiBoYW5kbGVBZGRDYXJkRm9ybVN1Ym1pdCh2YWx1ZSkge1xuLy8gXHRjb25zdCBuYW1lID0gdmFsdWUudGl0bGVcbi8vIFx0Y29uc3QgbGluayA9IHZhbHVlLmxpbmtcbi8vIFx0cmVuZGVyQ2FyZCh7IG5hbWUsIGxpbmsgfSwgY2FyZExpc3RFbCk7XG4vLyBcdGFkZENhcmRGb3JtRWxlbWVudC5yZXNldCgpO1xuLy8gXHRhZGRDYXJkUG9wdXAuY2xvc2UoKTtcbi8vIH1cblxuLy8gLy8gRXZlbnQgTGlzdGVuZXJzXG5cbi8vIHByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuLy8gXHRjb25zdCB1c2VyID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbi8vIFx0cHJvZmlsZVRpdGxlSW5wdXQudmFsdWUgPSB1c2VyLm5hbWU7XG4vLyBcdHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gdXNlci5qb2I7XG4vLyBcdGVkaXRQcm9maWxlUG9wdXAub3BlbigpO1xuLy8gfSk7XG5cbi8vIHByb2ZpbGVFZGl0Q2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4vLyBcdGVkaXRQcm9maWxlUG9wdXAuY2xvc2UoKTtcbi8vIH0pO1xuXG4vLyBwcmV2aWV3SW1hZ2VNb2RhbENsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuLy8gXHRwb3B1cEltYWdlTW9kYWwuY2xvc2UoKTtcbi8vIH0pO1xuXG4vLyBwcm9maWxlRWRpdE1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIGhhbmRsZU92ZXJsYXlDbG9zZSk7XG4vLyBhZGRDYXJkTW9kYWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgaGFuZGxlT3ZlcmxheUNsb3NlKTtcbi8vIHByZXZpZXdJbWFnZU1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIGhhbmRsZU92ZXJsYXlDbG9zZSk7XG5cbi8vIC8vbmV3IGNhcmRzXG4vLyBhZGROZXdDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuLy8gXHRhZGRDYXJkVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xuLy8gXHRhZGRDYXJkVmFsaWRhdG9yLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XG4vLyBcdGFkZENhcmRQb3B1cC5vcGVuKCk7XG4vLyB9KTtcbi8vIGFkZENhcmRNb2RhbENsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gYWRkQ2FyZFBvcHVwLmNsb3NlKCkpO1xuXG4vLyBjb25zdCBhZGRGb3JtRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNhZGQtY2FyZC1mb3JtJyk7XG4vLyBjb25zdCBlZGl0Rm9ybUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZWRpdC1jYXJkLWZvcm0nKTtcblxuLy8gY29uc3QgY29uZmlnID0ge1xuLy8gXHRmb3JtU2VsZWN0b3I6ICcubW9kYWxfX2Zvcm0nLFxuLy8gXHRpbnB1dFNlbGVjdG9yOiAnLm1vZGFsX19pbnB1dCcsXG4vLyBcdHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiAnLm1vZGFsX19idXR0b24nLFxuLy8gXHRpbmFjdGl2ZUJ1dHRvbkNsYXNzOiAnbW9kYWxfX2J1dHRvbl9kaXNhYmxlZCcsXG4vLyBcdGlucHV0RXJyb3JDbGFzczogJ21vZGFsX19pbnB1dF90eXBlX2Vycm9yJyxcbi8vIFx0ZXJyb3JDbGFzczogJ21vZGFsX19lcnJvcl92aXNpYmxlJyxcbi8vIFx0ZXJyb3JNZXNzYWdlRWw6ICcubW9kYWxfX2Vycm9yJyxcbi8vIH07XG5cbi8vIGNvbnN0IGFkZENhcmRWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIGFkZEZvcm1FbGVtZW50KTtcbi8vIGFkZENhcmRWYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG4vLyBjb25zdCBhZGRFZGl0VmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBlZGl0Rm9ybUVsZW1lbnQpO1xuLy8gYWRkRWRpdFZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcblx0YmFzZVVybDogJ2h0dHBzOi8vZXhhbXBsZS5jb20nLFxuXHRoZWFkZXJzOiAneW91ci1hdXRoLXRva2VuJ1xuICB9KTtcbiAgXG4gIGNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcblx0bmFtZVNlbGVjdG9yOiAnLnByb2ZpbGVfX25hbWUnLFxuXHRqb2JTZWxlY3RvcjogJy5wcm9maWxlX19qb2InXG4gIH0pO1xuICBcbiAgY29uc3QgZWRpdFByb2ZpbGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcblx0cG9wdXBTZWxlY3RvcjogJy5wb3B1cF90eXBlX2VkaXQtcHJvZmlsZScsXG5cdGZvcm1TdWJtaXRIYW5kbGVyOiBoYW5kbGVQcm9maWxlRWRpdFN1Ym1pdFxuICB9KTtcbiAgXG4gIGNvbnN0IGFkZENhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcblx0cG9wdXBTZWxlY3RvcjogJy5wb3B1cF90eXBlX2FkZC1jYXJkJyxcblx0Zm9ybVN1Ym1pdEhhbmRsZXI6IGhhbmRsZUFkZENhcmRGb3JtU3VibWl0XG4gIH0pO1xuICBcbiAgY29uc3QgcG9wdXBJbWFnZU1vZGFsID0gbmV3IFBvcHVwV2l0aEltYWdlKCcucG9wdXBfdHlwZV9pbWFnZScpO1xuICBcbiAgY29uc3QgYWRkTmV3Q2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hZGQtYnV0dG9uJyk7XG4gIGNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2VkaXQtYnV0dG9uJyk7XG4gIGNvbnN0IHByb2ZpbGVFZGl0Q2xvc2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9lZGl0LXByb2ZpbGUgLnBvcHVwX19jbG9zZS1idXR0b24nKTtcbiAgY29uc3QgYWRkQ2FyZE1vZGFsQ2xvc2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9hZGQtY2FyZCAucG9wdXBfX2Nsb3NlLWJ1dHRvbicpO1xuICBjb25zdCBwcmV2aWV3SW1hZ2VNb2RhbENsb3NlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfaW1hZ2UgLnBvcHVwX19jbG9zZS1idXR0b24nKTtcbiAgY29uc3QgcHJvZmlsZUVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX2VkaXQtcHJvZmlsZScpO1xuICBjb25zdCBhZGRDYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9hZGQtY2FyZCcpO1xuICBjb25zdCBwcmV2aWV3SW1hZ2VNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX2ltYWdlJyk7XG4gIFxuICBjb25zdCBwcm9maWxlVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX2VkaXQtcHJvZmlsZSAucG9wdXBfX2lucHV0X3R5cGVfbmFtZScpO1xuICBjb25zdCBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX2VkaXQtcHJvZmlsZSAucG9wdXBfX2lucHV0X3R5cGVfZGVzY3JpcHRpb24nKTtcbiAgXG4gIGNvbnN0IGFkZEZvcm1FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2FkZC1jYXJkLWZvcm0nKTtcbiAgY29uc3QgZWRpdEZvcm1FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2VkaXQtY2FyZC1mb3JtJyk7XG4gIFxuICBjb25zdCBhZGRDYXJkVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBhZGRGb3JtRWxlbWVudCk7XG4gIGNvbnN0IGVkaXRQcm9maWxlVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBlZGl0Rm9ybUVsZW1lbnQpO1xuICBcbiAgYXBpLmdldEFsbERhdGEoKVxuXHQudGhlbigoW3VzZXJJbmZvRGF0YSwgaW5pdGlhbENhcmRzRGF0YV0pID0+IHtcblx0ICB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VySW5mb0RhdGEpO1xuXHQgIGNvbnN0IGNhcmRzTGlzdCA9IG5ldyBTZWN0aW9uKHtcblx0XHRpdGVtczogaW5pdGlhbENhcmRzRGF0YSxcblx0XHRyZW5kZXJlcjogKGNhcmREYXRhKSA9PiB7XG5cdFx0ICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmRFbGVtZW50KGNhcmREYXRhKTtcblx0XHQgIGNhcmRzTGlzdC5hZGRJdGVtKGNhcmRFbGVtZW50KTtcblx0XHR9XG5cdCAgfSwgJy5jYXJkc19fbGlzdCcpO1xuXHQgIGNhcmRzTGlzdC5yZW5kZXJJdGVtcygpO1xuXHR9KVxuXHQuY2F0Y2goKGVycikgPT4ge1xuXHQgIGNvbnNvbGUubG9nKGVycik7XG5cdH0pO1xuICBcbiAgZnVuY3Rpb24gY3JlYXRlQ2FyZEVsZW1lbnQoY2FyZERhdGEpIHtcblx0Y29uc3QgY2FyZCA9IG5ldyBDYXJkKHtcblx0ICBkYXRhOiBjYXJkRGF0YSxcblx0ICBoYW5kbGVDYXJkQ2xpY2s6ICgpID0+IHtcblx0XHRwb3B1cEltYWdlTW9kYWwub3BlbihjYXJkRGF0YS5uYW1lLCBjYXJkRGF0YS5saW5rKTtcblx0ICB9LFxuXHQgIGhhbmRsZUxpa2VDbGljazogKCkgPT4ge1xuXHRcdGNvbnN0IGlzTGlrZWQgPSBjYXJkLmlzTGlrZWQoKTtcblx0XHRhcGkuY2hhbmdlTGlrZUNhcmRTdGF0dXMoY2FyZERhdGEuX2lkLCAhaXNMaWtlZClcblx0XHQgIC50aGVuKCh1cGRhdGVkQ2FyZERhdGEpID0+IHtcblx0XHRcdGNhcmQudXBkYXRlTGlrZXModXBkYXRlZENhcmREYXRhLmxpa2VzKTtcblx0XHQgIH0pXG5cdFx0ICAuY2F0Y2goKGVycikgPT4ge1xuXHRcdFx0Y29uc29sZS5sb2coZXJyKTtcblx0XHQgIH0pO1xuXHQgIH0sXG5cdCAgaGFuZGxlVHJhc2hDbGljazogKCkgPT4ge1xuXHRcdGNvbnN0IGNhcmRJZCA9IGNhcmREYXRhLl9pZDtcblx0XHRjb25zdCBjb25maXJtRGVsZXRlUG9wdXAgPSBuZXcgUG9wdXBXaXRoQ29uZmlybSh7XG5cdFx0ICBwb3B1cFNlbGVjdG9yOiAnLnBvcHVwX3R5cGVfY29uZmlybS1kZWxldGUnLFxuXHRcdCAgZm9ybVN1Ym1pdEhhbmRsZXI6ICgpID0+IHtcblx0XHRcdGFwaS5kZWxldGVDYXJkKGNhcmRJZClcblx0XHRcdCAgLnRoZW4oKCkgPT4ge1xuXHRcdFx0XHRjYXJkLmRlbGV0ZUNhcmQoKTtcblx0XHRcdFx0Y29uZmlybURlbGV0ZVBvcHVwLmNsb3NlKCk7XG5cdFx0XHQgIH0pXG5cdFx0XHQgIC5jYXRjaCgoZXJyKSA9PiB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKGVycik7XG5cdFx0XHQgIH0pO1xuXHRcdCAgfVxuXHRcdH0pO1xuXHRcdGNvbmZpcm1EZWxldGVQb3B1cC5vcGVuKCk7XG5cdCAgfVxuXHR9LCAnI2NhcmQtdGVtcGxhdGUnKTtcblx0cmV0dXJuIGNhcmQuZ2VuZXJhdGVDYXJkKCk7XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVFZGl0U3VibWl0KGZvcm1EYXRhKSB7XG5cdGVkaXRQcm9maWxlUG9wdXAuc2V0TG9hZGluZyh0cnVlKTtcblx0YXBpLmVkaXRVc2VySW5mbyhmb3JtRGF0YSlcblx0ICAudGhlbigodXNlckluZm9EYXRhKSA9PiB7XG5cdFx0dXNlckluZm8uc2V0VXNlckluZm8odXNlckluZm9EYXRhKTtcblx0XHRlZGl0UHJvZmlsZVBvcHVwLmNsb3NlKCk7XG5cdCAgfSlcblx0ICAuY2F0Y2goKGVycikgPT4ge1xuXHRcdGNvbnNvbGUubG9nKGVycik7XG5cdCAgfSlcblx0ICAuZmluYWxseSgoKSA9PiB7XG5cdFx0ZWRpdFByb2ZpbGVQb3B1cC5zZXRMb2FkaW5nKGZhbHNlKTtcblx0ICB9KTtcbiAgfVxuICBcbiAgZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZEZvcm1TdWJtaXQoZm9ybURhdGEpIHtcblx0YWRkQ2FyZFBvcHVwLnNldExvYWRpbmcodHJ1ZSk7XG5cdGFwaS5hZGRDYXJkKGZvcm1EYXRhKVxuXHQgIC50aGVuKChjYXJkRGF0YSkgPT4ge1xuXHRcdGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZEVsZW1lbnQoY2FyZERhdGEpO1xuXHRcdGNvbnN0IGNhcmRzTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkc19fbGlzdCcpO1xuXHRcdGNhcmRzTGlzdC5wcmVwZW5kKGNhcmRFbGVtZW50KTtcblx0XHRhZGRDYXJkUG9wdXAuY2xvc2UoKTtcblx0ICB9KVxuXHQgIC5jYXRjaCgoZXJyKSA9PiB7XG5cdFx0Y29uc29sZS5sb2coZXJyKTtcblx0ICB9KVxuXHQgIC5maW5hbGx5KCgpID0+IHtcblx0XHRhZGRDYXJkUG9wdXAuc2V0TG9hZGluZyhmYWxzZSk7XG5cdCAgfSk7XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIGhhbmRsZU92ZXJsYXlDbG9zZShldmVudCkge1xuXHRpZiAoZXZlbnQudGFyZ2V0ID09PSBldmVudC5jdXJyZW50VGFyZ2V0KSB7XG5cdCAgY29uc3QgcG9wdXAgPSBldmVudC50YXJnZXQucXVlcnlTZWxlY3RvcignLnBvcHVwJyk7XG5cdCAgaWYgKHBvcHVwKSB7XG5cdFx0cG9wdXAuY2xhc3NMaXN0LnJlbW92ZSgncG9wdXBfb3BlbmVkJyk7XG5cdCAgfVxuXHR9XG4gIH1cbiAgXG4gIHByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuXHRjb25zdCB1c2VyID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcblx0cHJvZmlsZVRpdGxlSW5wdXQudmFsdWUgPSB1c2VyLm5hbWU7XG5cdHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gdXNlci5qb2I7XG5cdGVkaXRQcm9maWxlUG9wdXAub3BlbigpO1xuICB9KTtcbiAgXG4gIHByb2ZpbGVFZGl0Q2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG5cdGVkaXRQcm9maWxlUG9wdXAuY2xvc2UoKTtcbiAgfSk7XG4gIFxuICBwcmV2aWV3SW1hZ2VNb2RhbENsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuXHRwb3B1cEltYWdlTW9kYWwuY2xvc2UoKTtcbiAgfSk7XG4gIFxuICBwcm9maWxlRWRpdE1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIGhhbmRsZU92ZXJsYXlDbG9zZSk7XG4gIGFkZENhcmRNb2RhbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBoYW5kbGVPdmVybGF5Q2xvc2UpO1xuICBwcmV2aWV3SW1hZ2VNb2RhbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBoYW5kbGVPdmVybGF5Q2xvc2UpO1xuICBcbiAgYWRkTmV3Q2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0YWRkQ2FyZFZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcblx0YWRkQ2FyZFZhbGlkYXRvci50b2dnbGVCdXR0b25TdGF0ZSgpO1xuXHRhZGRDYXJkUG9wdXAub3BlbigpO1xuICB9KTtcbiAgXG4gIGFkZENhcmRNb2RhbENsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gYWRkQ2FyZFBvcHVwLmNsb3NlKCkpO1xuICBcbiAgZWRpdEZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldmVudCkgPT4ge1xuXHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRlZGl0UHJvZmlsZVZhbGlkYXRvci5zZXRMb2FkaW5nKHRydWUpO1xuXHRlZGl0UHJvZmlsZVZhbGlkYXRvci5kaXNhYmxlU3VibWl0QnV0dG9uKCk7XG5cdGhhbmRsZVByb2ZpbGVFZGl0U3VibWl0KG5ldyBGb3JtRGF0YShldmVudC50YXJnZXQpKTtcbiAgfSk7XG4gIFxuICBhZGRGb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZXZlbnQpID0+IHtcblx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0YWRkQ2FyZFZhbGlkYXRvci5zZXRMb2FkaW5nKHRydWUpO1xuXHRhZGRDYXJkVmFsaWRhdG9yLmRpc2FibGVTdWJtaXRCdXR0b24oKTtcblx0aGFuZGxlQWRkQ2FyZEZvcm1TdWJtaXQobmV3IEZvcm1EYXRhKGV2ZW50LnRhcmdldCkpO1xuICB9KTtcbiAgXG4gIGFkZENhcmRWYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuICBlZGl0UHJvZmlsZVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3Ioe2Jhc2VVcmwsIGhlYWRlcnN9KSB7XG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XG4gIH1cblxuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcbiAgICBpZiAocmVzLm9rKSB7XG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICB9XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgaGVhZGVyczoge1xuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl9oZWFkZXJzXG4gICAgICB9XG4gICAgfSlcbiAgICAudGhlbihyZXMgPT4gdGhpcy5fY2hlY2tSZXNwb25zZShyZXMpKTtcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhUb2tlblxuICAgICAgfVxuICAgIH0pXG4gICAgLnRoZW4ocmVzID0+IHRoaXMuX2NoZWNrUmVzcG9uc2UocmVzKSk7XG4gIH1cblxuICBjcmVhdGVDYXJkKHsgbmFtZSwgbGluayB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgbmFtZSwgbGluayB9KSxcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG5cbiAgdXBkYXRlRWRpdFByb2ZpbGUoeyBuYW1lLCBhYm91dCB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IG5hbWUsIGFib3V0IH0pLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gICAgfVxuXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICAgIH1cblxuICBsaWtlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gICAgfVxuXG4gIHVubGlrZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICAgIH1cbiAgICBcbiAgdXBkYXRlQXZhdGFyKHVwZGF0ZWRBdmF0YXIpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGF2YXRhcjogdXBkYXRlZEF2YXRhciB9KSxcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICAgIH1cblxuICBnZXRBbGxEYXRhKCkge1xuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5fZ2V0VXNlckluZm8oKSwgdGhpcy5fZ2V0SW5pdGlhbENhcmRzKCldKTtcbiAgfVxufSIsImNsYXNzIFVzZXJJbmZvIHtcbiAgICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3Rvciwgam9iU2VsZWN0b3IgfSkge1xuICAgICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XG4gICAgICB0aGlzLl9hYm91dEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGpvYlNlbGVjdG9yKTtcbiAgICB9XG4gIFxuICAgIGdldFVzZXJJbmZvKCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbmFtZTogdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgICAgIGpvYjogdGhpcy5fYWJvdXRFbGVtZW50LnRleHRDb250ZW50XG4gICAgICB9O1xuICAgIH1cbiAgXG4gICAgc2V0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XG4gICAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgICB0aGlzLl9hYm91dEVsZW1lbnQudGV4dENvbnRlbnQgPSBhYm91dDtcbiAgICB9XG4gIH1cbiAgXG4gIGV4cG9ydCBkZWZhdWx0IFVzZXJJbmZvOyIsImltcG9ydCBQb3B1cCBmcm9tICcuL1BvcHVwLmpzJztcblxuY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG5cdGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcblx0XHRzdXBlcihwb3B1cFNlbGVjdG9yKTtcblx0XHR0aGlzLl9wb3B1cEltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9faW1hZ2UnKTtcblx0XHR0aGlzLl9wb3B1cFRpdGxlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fdGl0bGUnKTtcblx0fVxuXG5cdG9wZW4oeyBuYW1lLCBsaW5rIH0pIHtcblx0XHR0aGlzLl9wb3B1cEltYWdlLnNyYyA9IGxpbms7XG5cdFx0dGhpcy5fcG9wdXBJbWFnZS5hbHQgPSBuYW1lO1xuXHRcdHRoaXMuX3BvcHVwVGl0bGUudGV4dENvbnRlbnQgPSBuYW1lO1xuXHRcdHN1cGVyLm9wZW4oKTtcblx0fVxufVxuXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhJbWFnZTtcbiJdLCJuYW1lcyI6WyJjb25zdHJ1Y3RvciIsIl9yZWYiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlVHJhc2hDbGljayIsImhhbmRsZUxpa2VDbGljayIsIm5hbWUiLCJsaW5rIiwiX2lkIiwiaXNMaWtlZCIsInRoaXMiLCJfbmFtZSIsIl9saW5rIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfY2FyZFNlbGVjdG9yIiwiX2lzTGlrZWQiLCJfaGFuZGxlVHJhc2hDbGljayIsIl9oYW5kbGVMaWtlQ2xpY2siLCJfZ2V0VGVtcGxhdGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJjbG9uZU5vZGUiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfY2FyZEVsZW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiX2hhbmRsZUxpa2VJY29uIiwiX2hhbmRsZVJlbW92ZUNhcmQiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJyZW1vdmUiLCJnZXRWaWV3IiwiY2FyZEltYWdlIiwic3JjIiwiYWx0IiwidGV4dENvbnRlbnQiLCJGb3JtVmFsaWRhdG9yIiwiY29uZmlnIiwiZm9ybUVsZW1lbnQiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZXJyb3JNZXNzYWdlRWwiLCJlcnJvck1lc3NhZ2VFbCIsIl9mb3JtRWxlbWVudCIsIl9pbnB1dEVsZW1lbnRzIiwicXVlcnlTZWxlY3RvckFsbCIsIl9zdWJtaXRCdXR0b24iLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJpZCIsImFkZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiY29uc29sZSIsIndhcm4iLCJfaGlkZUlucHV0RXJyb3IiLCJfaGFzSW52YWxpZElucHV0IiwiZXZlcnkiLCJ2YWxpZGl0eSIsInZhbGlkIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJkaXNhYmxlZCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJmb3JtRWxzIiwiZm9yRWFjaCIsImVuYWJsZVZhbGlkYXRpb24iLCJlIiwicHJldmVudERlZmF1bHQiLCJyZXNldFZhbGlkYXRpb24iLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50IiwiX29wZW4iLCJvcGVuIiwiYmluZCIsIl9jbG9zZSIsImNsb3NlIiwiX2hhbmRsZUVzY0Nsb3NlIiwiaGFuZGxlRXNjQ2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9wb3B1cEZvcm0iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsInJlc2V0IiwiX2dldElucHV0VmFsdWVzIiwiX2lucHV0TGlzdCIsIl9pbnB1dFZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJTZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiaXRlbSIsImFkZEl0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsImFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsIl9jaGVja1Jlc3BvbnNlIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImdldFVzZXJJbmZvIiwiZmV0Y2giLCJhdXRob3JpemF0aW9uIiwidGhlbiIsImdldEluaXRpYWxDYXJkcyIsIl9hdXRoVG9rZW4iLCJjcmVhdGVDYXJkIiwiX3JlZjIiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInVwZGF0ZUVkaXRQcm9maWxlIiwiX3JlZjMiLCJhYm91dCIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJsaWtlQ2FyZCIsInVubGlrZUNhcmQiLCJ1cGRhdGVBdmF0YXIiLCJ1cGRhdGVkQXZhdGFyIiwiYXZhdGFyIiwiZ2V0QWxsRGF0YSIsImFsbCIsIl9nZXRVc2VySW5mbyIsIl9nZXRJbml0aWFsQ2FyZHMiLCJ1c2VySW5mbyIsIm5hbWVTZWxlY3RvciIsImpvYlNlbGVjdG9yIiwiX25hbWVFbGVtZW50IiwiX2Fib3V0RWxlbWVudCIsImpvYiIsInNldFVzZXJJbmZvIiwiZWRpdFByb2ZpbGVQb3B1cCIsIlBvcHVwV2l0aEZvcm0iLCJmb3JtU3VibWl0SGFuZGxlciIsImhhbmRsZVByb2ZpbGVFZGl0U3VibWl0IiwiYWRkQ2FyZFBvcHVwIiwiaGFuZGxlQWRkQ2FyZEZvcm1TdWJtaXQiLCJwb3B1cEltYWdlTW9kYWwiLCJfcG9wdXBJbWFnZSIsIl9wb3B1cFRpdGxlIiwiYWRkTmV3Q2FyZEJ1dHRvbiIsInByb2ZpbGVFZGl0QnV0dG9uIiwicHJvZmlsZUVkaXRDbG9zZUJ1dHRvbiIsImFkZENhcmRNb2RhbENsb3NlQnV0dG9uIiwicHJldmlld0ltYWdlTW9kYWxDbG9zZUJ1dHRvbiIsInByb2ZpbGVFZGl0TW9kYWwiLCJhZGRDYXJkTW9kYWwiLCJwcmV2aWV3SW1hZ2VNb2RhbCIsInByb2ZpbGVUaXRsZUlucHV0IiwicHJvZmlsZURlc2NyaXB0aW9uSW5wdXQiLCJhZGRGb3JtRWxlbWVudCIsImVkaXRGb3JtRWxlbWVudCIsImFkZENhcmRWYWxpZGF0b3IiLCJlZGl0UHJvZmlsZVZhbGlkYXRvciIsImNyZWF0ZUNhcmRFbGVtZW50IiwiY2FyZERhdGEiLCJjYXJkIiwiQ2FyZCIsImRhdGEiLCJoYW5kbGVDYXJkQ2xpY2siLCJjaGFuZ2VMaWtlQ2FyZFN0YXR1cyIsInVwZGF0ZWRDYXJkRGF0YSIsInVwZGF0ZUxpa2VzIiwibGlrZXMiLCJjYXRjaCIsImVyciIsImxvZyIsImNvbmZpcm1EZWxldGVQb3B1cCIsIlBvcHVwV2l0aENvbmZpcm0iLCJnZW5lcmF0ZUNhcmQiLCJmb3JtRGF0YSIsInNldExvYWRpbmciLCJlZGl0VXNlckluZm8iLCJ1c2VySW5mb0RhdGEiLCJmaW5hbGx5IiwiYWRkQ2FyZCIsImNhcmRFbGVtZW50IiwiaGFuZGxlT3ZlcmxheUNsb3NlIiwiZXZlbnQiLCJjdXJyZW50VGFyZ2V0IiwicG9wdXAiLCJpbml0aWFsQ2FyZHNEYXRhIiwiY2FyZHNMaXN0IiwidXNlciIsImRpc2FibGVTdWJtaXRCdXR0b24iLCJGb3JtRGF0YSJdLCJzb3VyY2VSb290IjoiIn0=